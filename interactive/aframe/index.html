<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>ilzites aframe</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-environment-component/dist/aframe-environment-component.min.js"></script>
    <script>
      AFRAME.registerComponent('restrict-movement', {
        tick: function () {
          const cameraEl = this.el;
          const position = cameraEl.getAttribute('position');

          // Define the boundaries of the 3D model
          const minX = -5, maxX = 5;
          const minY = 0, maxY = 5;
          const minZ = -5, maxZ = 5;

          // Restrict the camera movement within the boundaries
          if (position.x < minX) position.x = minX;
          if (position.x > maxX) position.x = maxX;
          if (position.y < minY) position.y = minY;
          if (position.y > maxY) position.y = maxY;
          if (position.z < minZ) position.z = minZ;
          if (position.z > maxZ) position.z = maxZ;

          cameraEl.setAttribute('position', position);
        }
      });
    </script>
  </head>
  <body>
    <a-scene keyboard-shortcuts="enterVR: false">
      <a-assets>
        <a-asset-item id="my-model" src="case.glb"></a-asset-item>
        <img id="oliverbaby" src="oliverbaby.jpg">
        <img id="oliver" src="oliver.jpg">
        <img id="fish" src="fish.jpg">
        <img id="pupa" src="fish.jpg">
        <img id="ilze" src="ilze.jpg">
        <img id="cisco" src="cisco.jpg">
        <img id="ciscopc" src="ciscopc.jpg">
        <img id="zivs3" src="zivs3.JPG">
      </a-assets>

      <a-sky color="#EDC8FF"></a-sky>
      <a-light type="directional" color="#EDC8FF" intensity="3" position="-10 30 50"></a-light>

      <a-entity gltf-model="#my-model" position="0 13.75 0" scale="1 1 1" class="collidable"></a-entity>

      <a-entity id="camera" camera look-controls custom-movement-controls position="0 1.6 0">
        <a-entity raycaster="objects: .collidable; far: 1.5" id="raycaster" direction="0 0 -1"></a-entity>
      </a-entity>
      
      <a-image src="oliverbaby.jpg" 
        position="0 2.5 0.35" 
        rotation="0 0 0" 
        width="3.5" 
        height="4.5" 
        class="collidable">
      </a-image>
      <a-image src="oliver.jpg" 
        position="1.8 2.25 -0.5" 
        rotation="0 90 0" 
        width="1.2" 
        height="1.2" 
        class="collidable">
      </a-image>
      <a-image src="pupa.jpg" 
        position="1.8 3.5 -0.5" 
        rotation="0 90 0" 
        width="1.2" 
        height="1.2" 
        class="collidable">
      </a-image>
      <a-image src="ciscopc.jpg" 
        position="1.8 1 -0.5" 
        rotation="0 90 0" 
        width="1.2" 
        height="1.2" 
        class="collidable">
      </a-image>
      <a-image src="fish.jpg" 
        position="-0.1 4.3 -0.6" 
        rotation="90 0 0" 
        width="1.3" 
        height="1.3" 
        class="collidable">
      </a-image>
      <a-image src="cisco.jpg" 
        position="-1.9 3.3 -0.4" 
        rotation="0 90 0" 
        width="1.2" 
        height="1.2" 
        class="collidable">
      </a-image>
      <a-image src="ilze.jpg" 
        position="-1.3 3.1 -0.95" 
        rotation="0 90 0" 
        width="0.4" 
        height="0.4" 
        class="collidable">
      </a-image>
      <a-image src="zivs3.JPG"
      position="-0.7 3.15 -1.5"
      rotation="0 0 0"
      width="2"
      height="1.5"
      class="collidable">
      </a-image>

      <a-plane id="plane1" 
        position="0 0.9 0" 
        rotation="-90 0 0" 
        width="5" 
        height="3" 
        material="opacity: 0; transparent: true" 
        class="collidable">
      </a-plane>
      <a-plane id="plane3" 
        position="0 2 -1.5" 
        rotation="0 0 0" 
        width="5" 
        height="4" 
        material="opacity: 0; transparent: true" 
        class="collidable">
      </a-plane>
      <a-plane id="plane4" 
        position="-0.5 2 0.35" 
        rotation="0 0 0" 
        width="5" 
        height="4" 
        material="opacity: 0; transparent: true" 
        class="collidable">
      </a-plane>
      <a-plane id="plane5" 
        position="-1.8 1 1" 
        rotation="0 90 0" 
        width="5" 
        height="4" 
        material="opacity: 0; transparent: true" 
        class="collidable">
      </a-plane>
      <a-plane id="plane6" 
        position="1.7 1 1" 
        rotation="0 -90 0" 
        width="5" 
        height="4" 
        material="opacity: 0; transparent: true" 
        class="collidable">
      </a-plane>
    </a-scene>

    <script>
      // Register a custom-movement-controls component
      AFRAME.registerComponent('custom-movement-controls', {
        schema: {
          speed: {default: 0.007}
        },

        init: function () {
          this.direction = new THREE.Vector3();
          this.keys = {};
          this.move = {x: 0, y: 0, z: 0};

          window.addEventListener('keydown', (event) => {
            this.keys[event.key] = true;
          });

          window.addEventListener('keyup', (event) => {
            this.keys[event.key] = false;
          });
        },

        tick: function (time, delta) {
          const el = this.el;
          const data = this.data;
          const direction = this.direction;

          // Reset move direction
          this.move.x = 0;
          this.move.y = 0;
          this.move.z = 0;

          // Determine direction based on key presses
          if (this.keys['w']) { this.move.z -= data.speed; }
          if (this.keys['s']) { this.move.z += data.speed; }
          if (this.keys['a']) { this.move.x -= data.speed; }
          if (this.keys['d']) { this.move.x += data.speed; }
          if (this.keys['e']) { this.move.y += data.speed; }
          if (this.keys['q']) { this.move.y -= data.speed; }

          // Apply movement to the camera
          direction.set(this.move.x, this.move.y, this.move.z);
          direction.applyQuaternion(el.object3D.quaternion);
          el.object3D.position.add(direction);
        }
      });

      // Custom collision detection
      AFRAME.registerComponent('restrict-movement', {
        init: function () {
          const cameraEl = this.el;
          const raycasterEl = document.querySelector('#raycaster');

          raycasterEl.addEventListener('raycaster-intersection', (evt) => {
            const intersections = evt.detail.intersections;
            if (intersections.length > 0) {
              // Move the camera slightly back to avoid getting stuck
              const position = cameraEl.getAttribute('position');
              position.z += 0.1;  // Adjust this value as needed
              cameraEl.setAttribute('position', position);
            }
          });
        }
      });

      // Apply restrict-movement component to the camera
      document.querySelector('#camera').setAttribute('restrict-movement', '');
    </script>
    
    
    
    
  </body>
</html>